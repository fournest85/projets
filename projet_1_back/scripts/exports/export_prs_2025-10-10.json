[
  {
    "_id": "68ec9cc5c833581caeac73ef",
    "number": 22,
    "created_at": "2025-10-10T15:25:12.000Z",
    "date": "2025-10-14T08:58:36.560Z",
    "files": [
      {
        "filename": "controller/pr.js",
        "status": "modified",
        "additions": 8,
        "deletions": 3,
        "changes": 11,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/controller%2Fpr.js",
        "modifiedLines": [
          {
            "line": null,
            "type": "removed",
            "content": "            query = { updated_at: { $gte: startDate, $lte: endDate } };"
          },
          {
            "line": 27,
            "type": "added",
            "content": "            console.log('🔍 Filtrage entre', startDate, 'et', endDate);"
          },
          {
            "line": 28,
            "type": "added",
            "content": "            query = {"
          },
          {
            "line": 29,
            "type": "added",
            "content": "                $or: ["
          },
          {
            "line": 30,
            "type": "added",
            "content": "                    { updated_at: { $gte: startDate, $lte: endDate } },"
          },
          {
            "line": 31,
            "type": "added",
            "content": "                    { created_at: { $gte: startDate, $lte: endDate } }"
          },
          {
            "line": 32,
            "type": "added",
            "content": "                ]"
          },
          {
            "line": 33,
            "type": "added",
            "content": "            };"
          },
          {
            "line": 34,
            "type": "added",
            "content": "            console.log('🧪 Requête MongoDB :', query);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        // console.log(` 📥 getPRs appelé avec date=${date}, page=${page}, limit=${limit}`);"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          }
        ],
        "diff": []
      },
      {
        "filename": "controller/user.js",
        "status": "modified",
        "additions": 4,
        "deletions": 3,
        "changes": 7,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/controller%2Fuser.js",
        "modifiedLines": [
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "                const match = githubUser.githubUrl.match(/github\\\\.com\\/([^\\/]+)/);"
          },
          {
            "line": 183,
            "type": "added",
            "content": "                console.log(`🔧 Tentative reconstruction login depuis githubUrl : ${githubUser.githubUrl}`);"
          },
          {
            "line": 184,
            "type": "added",
            "content": "                const match = githubUser.githubUrl.match(/github\\.com\\/([^\\/]+)/);"
          },
          {
            "line": 185,
            "type": "added",
            "content": "                console.log(`🔍 Résultat regex :`, match);"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": 191,
            "type": "added",
            "content": "                console.log(`🔍 PR sans login détectée :`, pr);"
          }
        ],
        "diff": []
      },
      {
        "filename": "jobs/githubCron.js",
        "status": "modified",
        "additions": 18,
        "deletions": 2,
        "changes": 20,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/jobs%2FgithubCron.js",
        "modifiedLines": [
          {
            "line": null,
            "type": "removed",
            "content": "const { exportPRsToJson } = require('../scripts/export-prs');"
          },
          {
            "line": null,
            "type": "removed",
            "content": "const { generateRapportMarkdown } = require(\"../scripts/generateRapport\");"
          },
          {
            "line": 3,
            "type": "added",
            "content": "const { exportPRsToJson, generateWeeklyReport } = require('../scripts/export-prs');"
          },
          {
            "line": 4,
            "type": "added",
            "content": "const { generateRapportMarkdown, generateWeeklyMarkdownReport } = require(\"../scripts/generateRapport\");"
          },
          {
            "line": 6,
            "type": "added",
            "content": "const schedule = require('node-schedule');"
          },
          {
            "line": 13,
            "type": "added",
            "content": "    // 🔁 Tâche quotidienne"
          },
          {
            "line": 44,
            "type": "added",
            "content": ""
          },
          {
            "line": 45,
            "type": "added",
            "content": ""
          },
          {
            "line": 46,
            "type": "added",
            "content": "    // 🕐 Tâche hebdomadaire : chaque lundi à 01h00"
          },
          {
            "line": 47,
            "type": "added",
            "content": "    schedule.scheduleJob('0 1 * * 1', () => {"
          },
          {
            "line": 48,
            "type": "added",
            "content": "        console.log('📅 Tâche cron : génération du rapport hebdomadaire');"
          },
          {
            "line": 49,
            "type": "added",
            "content": "        generateWeeklyReport();"
          },
          {
            "line": 50,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 51,
            "type": "added",
            "content": ""
          },
          {
            "line": 52,
            "type": "added",
            "content": "    schedule.scheduleJob('0 1 * * 1', () => {"
          },
          {
            "line": 53,
            "type": "added",
            "content": "        console.log('📄 Tâche cron : génération du rapport Markdown hebdomadaire');"
          },
          {
            "line": 54,
            "type": "added",
            "content": "        generateWeeklyMarkdownReport();"
          },
          {
            "line": 55,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 56,
            "type": "added",
            "content": ""
          },
          {
            "line": 57,
            "type": "added",
            "content": ""
          }
        ],
        "diff": []
      },
      {
        "filename": "package-lock.json",
        "status": "modified",
        "additions": 99,
        "deletions": 0,
        "changes": 99,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/package-lock.json",
        "modifiedLines": [
          {
            "line": 22,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 23,
            "type": "added",
            "content": "      \"devDependencies\": {"
          },
          {
            "line": 24,
            "type": "added",
            "content": "        \"cross-env\": \"^10.1.0\""
          },
          {
            "line": 27,
            "type": "added",
            "content": "    \"node_modules/@epic-web/invariant\": {"
          },
          {
            "line": 28,
            "type": "added",
            "content": "      \"version\": \"1.0.0\","
          },
          {
            "line": 29,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/@epic-web/invariant/-/invariant-1.0.0.tgz\","
          },
          {
            "line": 30,
            "type": "added",
            "content": "      \"integrity\": \"sha512-lrTPqgvfFQtR/eY/qkIzp98OGdNJu0m5ji3q/nJI8v3SXkRKEnWiOxMmbvcSoAIzv/cGiuvRy57k4suKQSAdwA==\","
          },
          {
            "line": 31,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 32,
            "type": "added",
            "content": "      \"license\": \"MIT\""
          },
          {
            "line": 33,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 317,
            "type": "added",
            "content": "    \"node_modules/cross-env\": {"
          },
          {
            "line": 318,
            "type": "added",
            "content": "      \"version\": \"10.1.0\","
          },
          {
            "line": 319,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/cross-env/-/cross-env-10.1.0.tgz\","
          },
          {
            "line": 320,
            "type": "added",
            "content": "      \"integrity\": \"sha512-GsYosgnACZTADcmEyJctkJIoqAhHjttw7RsFrVoJNXbsWWqaq6Ym+7kZjq6mS45O0jij6vtiReppKQEtqWy6Dw==\","
          },
          {
            "line": 321,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 322,
            "type": "added",
            "content": "      \"license\": \"MIT\","
          },
          {
            "line": 323,
            "type": "added",
            "content": "      \"dependencies\": {"
          },
          {
            "line": 324,
            "type": "added",
            "content": "        \"@epic-web/invariant\": \"^1.0.0\","
          },
          {
            "line": 325,
            "type": "added",
            "content": "        \"cross-spawn\": \"^7.0.6\""
          },
          {
            "line": 326,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 327,
            "type": "added",
            "content": "      \"bin\": {"
          },
          {
            "line": 328,
            "type": "added",
            "content": "        \"cross-env\": \"dist/bin/cross-env.js\","
          },
          {
            "line": 329,
            "type": "added",
            "content": "        \"cross-env-shell\": \"dist/bin/cross-env-shell.js\""
          },
          {
            "line": 330,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 331,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 332,
            "type": "added",
            "content": "        \"node\": \">=20\""
          },
          {
            "line": 333,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 334,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 335,
            "type": "added",
            "content": "    \"node_modules/cross-spawn\": {"
          },
          {
            "line": 336,
            "type": "added",
            "content": "      \"version\": \"7.0.6\","
          },
          {
            "line": 337,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz\","
          },
          {
            "line": 338,
            "type": "added",
            "content": "      \"integrity\": \"sha512-uV2QOWP2nWzsy2aMp8aRibhi9dlzF5Hgh5SHaB9OiTGEyDTiJJyx0uy51QXdyWbtAHNua4XJzUKca3OzKUd3vA==\","
          },
          {
            "line": 339,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 340,
            "type": "added",
            "content": "      \"license\": \"MIT\","
          },
          {
            "line": 341,
            "type": "added",
            "content": "      \"dependencies\": {"
          },
          {
            "line": 342,
            "type": "added",
            "content": "        \"path-key\": \"^3.1.0\","
          },
          {
            "line": 343,
            "type": "added",
            "content": "        \"shebang-command\": \"^2.0.0\","
          },
          {
            "line": 344,
            "type": "added",
            "content": "        \"which\": \"^2.0.1\""
          },
          {
            "line": 345,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 346,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 347,
            "type": "added",
            "content": "        \"node\": \">= 8\""
          },
          {
            "line": 348,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 349,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 973,
            "type": "added",
            "content": "    \"node_modules/isexe\": {"
          },
          {
            "line": 974,
            "type": "added",
            "content": "      \"version\": \"2.0.0\","
          },
          {
            "line": 975,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/isexe/-/isexe-2.0.0.tgz\","
          },
          {
            "line": 976,
            "type": "added",
            "content": "      \"integrity\": \"sha512-RHxMLp9lnKHGHRng9QFhRCMbYAcVpn69smSGcq3f36xjgVVWThj4qqLbTLlq7Ssj8B+fIQ1EuCEGI2lKsyQeIw==\","
          },
          {
            "line": 977,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 978,
            "type": "added",
            "content": "      \"license\": \"ISC\""
          },
          {
            "line": 979,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 1235,
            "type": "added",
            "content": "    \"node_modules/path-key\": {"
          },
          {
            "line": 1236,
            "type": "added",
            "content": "      \"version\": \"3.1.1\","
          },
          {
            "line": 1237,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/path-key/-/path-key-3.1.1.tgz\","
          },
          {
            "line": 1238,
            "type": "added",
            "content": "      \"integrity\": \"sha512-ojmeN0qd+y0jszEtoY48r0Peq5dwMEkIlCOu6Q5f41lfkswXuKtYrhgoTpLnyIcHm24Uhqx+5Tqm2InSwLhE6Q==\","
          },
          {
            "line": 1239,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 1240,
            "type": "added",
            "content": "      \"license\": \"MIT\","
          },
          {
            "line": 1241,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 1242,
            "type": "added",
            "content": "        \"node\": \">=8\""
          },
          {
            "line": 1243,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 1244,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 1477,
            "type": "added",
            "content": "    \"node_modules/shebang-command\": {"
          },
          {
            "line": 1478,
            "type": "added",
            "content": "      \"version\": \"2.0.0\","
          },
          {
            "line": 1479,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/shebang-command/-/shebang-command-2.0.0.tgz\","
          },
          {
            "line": 1480,
            "type": "added",
            "content": "      \"integrity\": \"sha512-kHxr2zZpYtdmrN1qDjrrX/Z1rR1kG8Dx+gkpK1G4eXmvXswmcE1hTWBWYUzlraYw1/yZp6YuDY77YtvbN0dmDA==\","
          },
          {
            "line": 1481,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 1482,
            "type": "added",
            "content": "      \"license\": \"MIT\","
          },
          {
            "line": 1483,
            "type": "added",
            "content": "      \"dependencies\": {"
          },
          {
            "line": 1484,
            "type": "added",
            "content": "        \"shebang-regex\": \"^3.0.0\""
          },
          {
            "line": 1485,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 1486,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 1487,
            "type": "added",
            "content": "        \"node\": \">=8\""
          },
          {
            "line": 1488,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 1489,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 1490,
            "type": "added",
            "content": "    \"node_modules/shebang-regex\": {"
          },
          {
            "line": 1491,
            "type": "added",
            "content": "      \"version\": \"3.0.0\","
          },
          {
            "line": 1492,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/shebang-regex/-/shebang-regex-3.0.0.tgz\","
          },
          {
            "line": 1493,
            "type": "added",
            "content": "      \"integrity\": \"sha512-7++dFhtcx3353uBaq8DDR4NuxBetBzC7ZQOhmTQInHEd6bSrXdiEyzCvG07Z44UYdLShWUyXt5M/yhz8ekcb1A==\","
          },
          {
            "line": 1494,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 1495,
            "type": "added",
            "content": "      \"license\": \"MIT\","
          },
          {
            "line": 1496,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 1497,
            "type": "added",
            "content": "        \"node\": \">=8\""
          },
          {
            "line": 1498,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 1499,
            "type": "added",
            "content": "    },"
          },
          {
            "line": 1716,
            "type": "added",
            "content": "    \"node_modules/which\": {"
          },
          {
            "line": 1717,
            "type": "added",
            "content": "      \"version\": \"2.0.2\","
          },
          {
            "line": 1718,
            "type": "added",
            "content": "      \"resolved\": \"https://registry.npmjs.org/which/-/which-2.0.2.tgz\","
          },
          {
            "line": 1719,
            "type": "added",
            "content": "      \"integrity\": \"sha512-BLI3Tl1TW3Pvl70l3yq3Y64i+awpwXqsGBYWkkqMtnbXgrMD+yj7rhW0kuEDxzJaYXGjEW5ogapKNMEKNMjibA==\","
          },
          {
            "line": 1720,
            "type": "added",
            "content": "      \"dev\": true,"
          },
          {
            "line": 1721,
            "type": "added",
            "content": "      \"license\": \"ISC\","
          },
          {
            "line": 1722,
            "type": "added",
            "content": "      \"dependencies\": {"
          },
          {
            "line": 1723,
            "type": "added",
            "content": "        \"isexe\": \"^2.0.0\""
          },
          {
            "line": 1724,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 1725,
            "type": "added",
            "content": "      \"bin\": {"
          },
          {
            "line": 1726,
            "type": "added",
            "content": "        \"node-which\": \"bin/node-which\""
          },
          {
            "line": 1727,
            "type": "added",
            "content": "      },"
          },
          {
            "line": 1728,
            "type": "added",
            "content": "      \"engines\": {"
          },
          {
            "line": 1729,
            "type": "added",
            "content": "        \"node\": \">= 8\""
          },
          {
            "line": 1730,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 1731,
            "type": "added",
            "content": "    },"
          }
        ],
        "diff": []
      },
      {
        "filename": "package.json",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/package.json",
        "modifiedLines": [
          {
            "line": 22,
            "type": "added",
            "content": "  },"
          },
          {
            "line": 23,
            "type": "added",
            "content": "  \"devDependencies\": {"
          },
          {
            "line": 24,
            "type": "added",
            "content": "    \"cross-env\": \"^10.1.0\""
          }
        ],
        "diff": []
      },
      {
        "filename": "scripts/export-prs.js",
        "status": "modified",
        "additions": 52,
        "deletions": 1,
        "changes": 53,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2Fexport-prs.js",
        "modifiedLines": [
          {
            "line": 68,
            "type": "added",
            "content": "// 📅 Obtenir les dates de début et fin de la semaine précédente"
          },
          {
            "line": 69,
            "type": "added",
            "content": "function getPreviousWeekRange() {"
          },
          {
            "line": 70,
            "type": "added",
            "content": "    const today = new Date();"
          },
          {
            "line": 71,
            "type": "added",
            "content": "    const dayOfWeek = today.getDay(); // 0 = dimanche, 1 = lundi, ..."
          },
          {
            "line": 72,
            "type": "added",
            "content": "    const lastMonday = new Date(today);"
          },
          {
            "line": 73,
            "type": "added",
            "content": "    lastMonday.setDate(today.getDate() - dayOfWeek - 6);"
          },
          {
            "line": 74,
            "type": "added",
            "content": "    lastMonday.setHours(0, 0, 0, 0);"
          },
          {
            "line": 75,
            "type": "added",
            "content": ""
          },
          {
            "line": 76,
            "type": "added",
            "content": "    const lastSunday = new Date(lastMonday);"
          },
          {
            "line": 77,
            "type": "added",
            "content": "    lastSunday.setDate(lastMonday.getDate() + 6);"
          },
          {
            "line": 78,
            "type": "added",
            "content": "    lastSunday.setHours(23, 59, 59, 999);"
          },
          {
            "line": 79,
            "type": "added",
            "content": ""
          },
          {
            "line": 80,
            "type": "added",
            "content": "    return { start: lastMonday, end: lastSunday };"
          },
          {
            "line": 81,
            "type": "added",
            "content": "}"
          },
          {
            "line": 82,
            "type": "added",
            "content": ""
          },
          {
            "line": 83,
            "type": "added",
            "content": "// 📁 Lire tous les fichiers export_prs de la semaine"
          },
          {
            "line": 84,
            "type": "added",
            "content": "function getWeeklyExportFiles(startDate, endDate) {"
          },
          {
            "line": 85,
            "type": "added",
            "content": "    const files = fs.readdirSync(exportFolder);"
          },
          {
            "line": 86,
            "type": "added",
            "content": "    return files.filter(file => {"
          },
          {
            "line": 87,
            "type": "added",
            "content": "        if (!file.startsWith('export_prs_') || !file.endsWith('.json')) return false;"
          },
          {
            "line": 88,
            "type": "added",
            "content": "        const dateStr = file.slice(11, -5); // \"YYYY-MM-DD\""
          },
          {
            "line": 89,
            "type": "added",
            "content": "        const fileDate = new Date(dateStr);"
          },
          {
            "line": 90,
            "type": "added",
            "content": "        return fileDate >= startDate && fileDate <= endDate;"
          },
          {
            "line": 91,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 92,
            "type": "added",
            "content": "}"
          },
          {
            "line": 93,
            "type": "added",
            "content": ""
          },
          {
            "line": 94,
            "type": "added",
            "content": "// 🔄 Fusionner les PRs sans doublons"
          },
          {
            "line": 95,
            "type": "added",
            "content": "function mergePRs(files) {"
          },
          {
            "line": 96,
            "type": "added",
            "content": "    const merged = {};"
          },
          {
            "line": 97,
            "type": "added",
            "content": "    files.forEach(file => {"
          },
          {
            "line": 98,
            "type": "added",
            "content": "        const content = JSON.parse(fs.readFileSync(file, 'utf-8'));"
          },
          {
            "line": 99,
            "type": "added",
            "content": "        content.forEach(pr => {"
          },
          {
            "line": 100,
            "type": "added",
            "content": "            if (pr.number) merged[pr.number] = pr;"
          },
          {
            "line": 101,
            "type": "added",
            "content": "        });"
          },
          {
            "line": 102,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 103,
            "type": "added",
            "content": "    return Object.values(merged);"
          },
          {
            "line": 104,
            "type": "added",
            "content": "}"
          },
          {
            "line": 105,
            "type": "added",
            "content": ""
          },
          {
            "line": 106,
            "type": "added",
            "content": "// 📝 Générer le rapport hebdomadaire"
          },
          {
            "line": 107,
            "type": "added",
            "content": "function generateWeeklyReport() {"
          },
          {
            "line": 108,
            "type": "added",
            "content": "    const { start, end } = getPreviousWeekRange();"
          },
          {
            "line": 109,
            "type": "added",
            "content": "    const files = getWeeklyExportFiles(start, end);"
          },
          {
            "line": 110,
            "type": "added",
            "content": "    const mergedPRs = mergePRs(files);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "module.exports = { exportPRsToJson };"
          },
          {
            "line": 114,
            "type": "added",
            "content": "    const startStr = start.toISOString().slice(0, 10);"
          },
          {
            "line": 115,
            "type": "added",
            "content": "    const endStr = end.toISOString().slice(0, 10);"
          },
          {
            "line": 116,
            "type": "added",
            "content": "    const outputName = `export_prs_hebdo_${startStr}_au_${endStr}.json`;"
          },
          {
            "line": 117,
            "type": "added",
            "content": "    const outputPath = path.join(exportFolder, outputName);"
          },
          {
            "line": 118,
            "type": "added",
            "content": "    fs.writeFileSync(outputPath, JSON.stringify(mergedPRs, null, 2), 'utf-8');"
          },
          {
            "line": 119,
            "type": "added",
            "content": "    console.log(`✅ Rapport hebdomadaire généré : ${outputName}`);"
          },
          {
            "line": 120,
            "type": "added",
            "content": "}"
          },
          {
            "line": 121,
            "type": "added",
            "content": ""
          },
          {
            "line": 122,
            "type": "added",
            "content": "module.exports = { exportPRsToJson, generateWeeklyReport };"
          }
        ],
        "diff": []
      },
      {
        "filename": "scripts/exports/export_prs_2025-10-08.json",
        "status": "modified",
        "additions": 0,
        "deletions": 7,
        "changes": 7,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2Fexports%2Fexport_prs_2025-10-08.json",
        "modifiedLines": [
          {
            "line": null,
            "type": "removed",
            "content": "<<<<<<< HEAD"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    \"_id\": \"68e76049c833581caeac72b6\","
          },
          {
            "line": null,
            "type": "removed",
            "content": "    \"number\": 17,"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    \"created_at\": \"2025-10-08T15:24:58.000Z\","
          },
          {
            "line": null,
            "type": "removed",
            "content": "    \"date\": \"2025-10-09T09:02:09.250Z\","
          },
          {
            "line": null,
            "type": "removed",
            "content": "======="
          },
          {
            "line": null,
            "type": "removed",
            "content": ">>>>>>> 75ddf46bab80c3e3591382f1241f8537cd910e5d"
          }
        ],
        "diff": []
      },
      {
        "filename": "scripts/exports/export_prs_2025-10-09.json",
        "status": "added",
        "additions": 57148,
        "deletions": 0,
        "changes": 57148,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2Fexports%2Fexport_prs_2025-10-09.json",
        "modifiedLines": []
      },
      {
        "filename": "scripts/exports/rapport_2025-10-08.md",
        "status": "modified",
        "additions": 0,
        "deletions": 17,
        "changes": 17,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2Fexports%2Frapport_2025-10-08.md",
        "modifiedLines": [
          {
            "line": null,
            "type": "removed",
            "content": "<<<<<<< HEAD"
          },
          {
            "line": null,
            "type": "removed",
            "content": "Nombre total de PRs : 1"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "## 📊 Résumé global"
          },
          {
            "line": null,
            "type": "removed",
            "content": "- 👥 Contributeurs uniques : 1"
          },
          {
            "line": null,
            "type": "removed",
            "content": "======="
          },
          {
            "line": null,
            "type": "removed",
            "content": ">>>>>>> 75ddf46bab80c3e3591382f1241f8537cd910e5d"
          },
          {
            "line": null,
            "type": "removed",
            "content": "<<<<<<< HEAD"
          },
          {
            "line": null,
            "type": "removed",
            "content": "======="
          },
          {
            "line": null,
            "type": "removed",
            "content": ">>>>>>> 75ddf46bab80c3e3591382f1241f8537cd910e5d"
          },
          {
            "line": null,
            "type": "removed",
            "content": "<<<<<<< HEAD"
          },
          {
            "line": null,
            "type": "removed",
            "content": "- Nombre de PRs : 1"
          },
          {
            "line": null,
            "type": "removed",
            "content": "======="
          },
          {
            "line": null,
            "type": "removed",
            "content": ">>>>>>> 75ddf46bab80c3e3591382f1241f8537cd910e5d"
          },
          {
            "line": null,
            "type": "removed",
            "content": "<<<<<<< HEAD"
          },
          {
            "line": null,
            "type": "removed",
            "content": "======="
          },
          {
            "line": null,
            "type": "removed",
            "content": ">>>>>>> 75ddf46bab80c3e3591382f1241f8537cd910e5d"
          }
        ],
        "diff": []
      },
      {
        "filename": "scripts/exports/rapport_2025-10-09.md",
        "status": "added",
        "additions": 56,
        "deletions": 0,
        "changes": 56,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2Fexports%2Frapport_2025-10-09.md",
        "modifiedLines": [
          {
            "line": 1,
            "type": "added",
            "content": "# Rapport des PRs - 2025-10-09"
          },
          {
            "line": 2,
            "type": "added",
            "content": ""
          },
          {
            "line": 3,
            "type": "added",
            "content": "Nombre total de PRs : 4"
          },
          {
            "line": 4,
            "type": "added",
            "content": ""
          },
          {
            "line": 5,
            "type": "added",
            "content": "## 📊 Résumé global"
          },
          {
            "line": 6,
            "type": "added",
            "content": "- 👥 Contributeurs uniques : 1"
          },
          {
            "line": 7,
            "type": "added",
            "content": "- 📂 Fichiers modifiés (total) : 0"
          },
          {
            "line": 8,
            "type": "added",
            "content": "- ➕ Lignes ajoutées (total) : 0"
          },
          {
            "line": 9,
            "type": "added",
            "content": "- ➖ Lignes supprimées (total) : 0"
          },
          {
            "line": 10,
            "type": "added",
            "content": ""
          },
          {
            "line": 11,
            "type": "added",
            "content": "## ✅ Points forts"
          },
          {
            "line": 12,
            "type": "added",
            "content": "- Bonne répartition des contributions."
          },
          {
            "line": 13,
            "type": "added",
            "content": "- Plusieurs PRs fusionnées avec succès."
          },
          {
            "line": 14,
            "type": "added",
            "content": ""
          },
          {
            "line": 15,
            "type": "added",
            "content": "## 👥 Analyse par utilisateur"
          },
          {
            "line": 16,
            "type": "added",
            "content": "### 🔹 fournest85"
          },
          {
            "line": 17,
            "type": "added",
            "content": "- 👤 Profil GitHub : fournest85"
          },
          {
            "line": 18,
            "type": "added",
            "content": "- 🖼️ Avatar : !"
          },
          {
            "line": 19,
            "type": "added",
            "content": "- 🧬 Type : User"
          },
          {
            "line": 20,
            "type": "added",
            "content": "- 🔐 Admin GitHub : Non"
          },
          {
            "line": 21,
            "type": "added",
            "content": "- Nombre de PRs : 4"
          },
          {
            "line": 22,
            "type": "added",
            "content": "- Fichiers modifiés : 0"
          },
          {
            "line": 23,
            "type": "added",
            "content": "- Lignes ajoutées : 0"
          },
          {
            "line": 24,
            "type": "added",
            "content": "- Lignes supprimées : 0"
          },
          {
            "line": 25,
            "type": "added",
            "content": ""
          },
          {
            "line": 26,
            "type": "added",
            "content": "#### PR #20 - mise à jour de la branche"
          },
          {
            "line": 27,
            "type": "added",
            "content": "- 🔗 [Lien vers la PR](https://github.com/Elodie-Gateau/Mini-Twitter-Symfony/pull/20)  - 🕒 Créée le: 2025-10-09 17:23 "
          },
          {
            "line": 28,
            "type": "added",
            "content": "- 📂 Fichiers modifiés: undefined "
          },
          {
            "line": 29,
            "type": "added",
            "content": "- ➕ Additions: undefined, ➖ Deletions: undefined "
          },
          {
            "line": 30,
            "type": "added",
            "content": "- 📌 Statut: closed "
          },
          {
            "line": 31,
            "type": "added",
            "content": ""
          },
          {
            "line": 32,
            "type": "added",
            "content": "#### PR #21 - Test branche mise à jour"
          },
          {
            "line": 33,
            "type": "added",
            "content": "- 🔗 [Lien vers la PR](undefined)  - 🕒 Créée le: 2025-10-09 17:35 "
          },
          {
            "line": 34,
            "type": "added",
            "content": "- 📂 Fichiers modifiés: undefined "
          },
          {
            "line": 35,
            "type": "added",
            "content": "- ➕ Additions: undefined, ➖ Deletions: undefined "
          },
          {
            "line": 36,
            "type": "added",
            "content": "- 📌 Statut: closed "
          },
          {
            "line": 37,
            "type": "added",
            "content": ""
          },
          {
            "line": 38,
            "type": "added",
            "content": "#### PR #19 - resolutions de certains bugs et mise en place du split front/back"
          },
          {
            "line": 39,
            "type": "added",
            "content": "- 🔗 [Lien vers la PR](undefined)  - 🕒 Créée le: 2025-10-09 17:21 "
          },
          {
            "line": 40,
            "type": "added",
            "content": "- 📂 Fichiers modifiés: undefined "
          },
          {
            "line": 41,
            "type": "added",
            "content": "- ➕ Additions: undefined, ➖ Deletions: undefined "
          },
          {
            "line": 42,
            "type": "added",
            "content": "- 📌 Statut: closed "
          },
          {
            "line": 43,
            "type": "added",
            "content": ""
          },
          {
            "line": 44,
            "type": "added",
            "content": "#### PR #18 - resolutions de certains bugs et mise en place du split front/back"
          },
          {
            "line": 45,
            "type": "added",
            "content": "- 🔗 [Lien vers la PR](undefined)  - 🕒 Créée le: 2025-10-09 17:19 "
          },
          {
            "line": 46,
            "type": "added",
            "content": "- 📂 Fichiers modifiés: undefined "
          },
          {
            "line": 47,
            "type": "added",
            "content": "- ➕ Additions: undefined, ➖ Deletions: undefined "
          },
          {
            "line": 48,
            "type": "added",
            "content": "- 📌 Statut: closed "
          },
          {
            "line": 49,
            "type": "added",
            "content": ""
          },
          {
            "line": 50,
            "type": "added",
            "content": "## 🛠️ Améliorations recommandées"
          },
          {
            "line": 51,
            "type": "added",
            "content": "- Vérifier les PRs avec peu ou pas de description."
          },
          {
            "line": 52,
            "type": "added",
            "content": "- Encourager des commits plus atomiques."
          },
          {
            "line": 53,
            "type": "added",
            "content": "- Ajouter des reviewers pour les PRs critiques."
          },
          {
            "line": 54,
            "type": "added",
            "content": "## 🧹 Nettoyage de code"
          },
          {
            "line": 55,
            "type": "added",
            "content": "- Suppression de variables inutilisées : `today`, `dateStr`"
          },
          {
            "line": 56,
            "type": "added",
            "content": "- Suppression d’un import non utilisé : `const os = require('os')`"
          }
        ]
      },
      {
        "filename": "scripts/generateRapport.js",
        "status": "modified",
        "additions": 111,
        "deletions": 34,
        "changes": 145,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/scripts%2FgenerateRapport.js",
        "modifiedLines": [
          {
            "line": 5,
            "type": "added",
            "content": "const exportFolder = path.join(__dirname, 'exports'); // adapte si besoin"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        const { login, html_url: userUrl, avatar_url, type, site_admin } = userMeta; "
          },
          {
            "line": 61,
            "type": "added",
            "content": "        const { login, html_url: userUrl, avatar_url, type, site_admin } = userMeta;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            const totalFiles = userPRs.reduce((sum, pr) => sum + (pr.changed_files || 0), 0);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            const totalAdditions = userPRs.reduce((sum, pr) => sum + (pr.additions || 0), 0);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            const totalDeletions = userPRs.reduce((sum, pr) => sum + (pr.deletions || 0), 0);"
          },
          {
            "line": 63,
            "type": "added",
            "content": "        const totalFiles = userPRs.reduce((sum, pr) => sum + (pr.changed_files || 0), 0);"
          },
          {
            "line": 64,
            "type": "added",
            "content": "        const totalAdditions = userPRs.reduce((sum, pr) => sum + (pr.additions || 0), 0);"
          },
          {
            "line": 65,
            "type": "added",
            "content": "        const totalDeletions = userPRs.reduce((sum, pr) => sum + (pr.deletions || 0), 0);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            markdown += `### 🔹 ${login || 'inconnu'}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            if (userUrl) markdown += `- 👤 Profil GitHub : ${login}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            if (avatar_url) markdown += `- 🖼️ Avatar : !\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            if (type) markdown += `- 🧬 Type : ${type}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            if (site_admin !== undefined) markdown += `- 🔐 Admin GitHub : ${site_admin ? 'Oui' : 'Non'}\\n`;"
          },
          {
            "line": 67,
            "type": "added",
            "content": "        markdown += `### 🔹 ${login || 'inconnu'}\\n`;"
          },
          {
            "line": 68,
            "type": "added",
            "content": "        if (userUrl) markdown += `- 👤 Profil GitHub : ${login}\\n`;"
          },
          {
            "line": 69,
            "type": "added",
            "content": "        if (avatar_url) markdown += `- 🖼️ Avatar : !\\n`;"
          },
          {
            "line": 70,
            "type": "added",
            "content": "        if (type) markdown += `- 🧬 Type : ${type}\\n`;"
          },
          {
            "line": 71,
            "type": "added",
            "content": "        if (site_admin !== undefined) markdown += `- 🔐 Admin GitHub : ${site_admin ? 'Oui' : 'Non'}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            markdown += `- Nombre de PRs : ${userPRs.length}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            markdown += `- Fichiers modifiés : ${totalFiles}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            markdown += `- Lignes ajoutées : ${totalAdditions}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            markdown += `- Lignes supprimées : ${totalDeletions}\\n\\n`;"
          },
          {
            "line": 73,
            "type": "added",
            "content": "        markdown += `- Nombre de PRs : ${userPRs.length}\\n`;"
          },
          {
            "line": 74,
            "type": "added",
            "content": "        markdown += `- Fichiers modifiés : ${totalFiles}\\n`;"
          },
          {
            "line": 75,
            "type": "added",
            "content": "        markdown += `- Lignes ajoutées : ${totalAdditions}\\n`;"
          },
          {
            "line": 76,
            "type": "added",
            "content": "        markdown += `- Lignes supprimées : ${totalDeletions}\\n\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            userPRs.forEach(pr => {"
          },
          {
            "line": 79,
            "type": "added",
            "content": "        userPRs.forEach(pr => {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                markdown += `#### PR #${pr.number} - ${pr.title}\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                markdown += `- 🔗 [Lien vers la PR](${pr.html_url})  - 🕒 Créée le: ${dayjs(pr.created_at).format('YYYY-MM-DD HH:mm')} \\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                markdown += `- 📂 Fichiers modifiés: ${pr.changed_files} \\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                markdown += `- ➕ Additions: ${pr.additions}, ➖ Deletions: ${pr.deletions} \\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                markdown += `- 📌 Statut: ${pr.state} \\n\\n`;"
          },
          {
            "line": 81,
            "type": "added",
            "content": "            markdown += `#### PR #${pr.number} - ${pr.title}\\n`;"
          },
          {
            "line": 82,
            "type": "added",
            "content": "            markdown += `- 🔗 [Lien vers la PR](${pr.html_url})  - 🕒 Créée le: ${dayjs(pr.created_at).format('YYYY-MM-DD HH:mm')} \\n`;"
          },
          {
            "line": 83,
            "type": "added",
            "content": "            markdown += `- 📂 Fichiers modifiés: ${pr.changed_files} \\n`;"
          },
          {
            "line": 84,
            "type": "added",
            "content": "            markdown += `- ➕ Additions: ${pr.additions}, ➖ Deletions: ${pr.deletions} \\n`;"
          },
          {
            "line": 85,
            "type": "added",
            "content": "            markdown += `- 📌 Statut: ${pr.state} \\n\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            });"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        }"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "        // Suggestions d'amélioration"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `## 🛠️ Améliorations recommandées\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `- Vérifier les PRs avec peu ou pas de description.\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `- Encourager des commits plus atomiques.\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `- Ajouter des reviewers pour les PRs critiques.\\n`;"
          },
          {
            "line": 87,
            "type": "added",
            "content": "        });"
          },
          {
            "line": 88,
            "type": "added",
            "content": "    }"
          },
          {
            "line": 90,
            "type": "added",
            "content": "    // Suggestions d'amélioration"
          },
          {
            "line": 91,
            "type": "added",
            "content": "    markdown += `## 🛠️ Améliorations recommandées\\n`;"
          },
          {
            "line": 92,
            "type": "added",
            "content": "    markdown += `- Vérifier les PRs avec peu ou pas de description.\\n`;"
          },
          {
            "line": 93,
            "type": "added",
            "content": "    markdown += `- Encourager des commits plus atomiques.\\n`;"
          },
          {
            "line": 94,
            "type": "added",
            "content": "    markdown += `- Ajouter des reviewers pour les PRs critiques.\\n`;"
          },
          {
            "line": 95,
            "type": "added",
            "content": ""
          },
          {
            "line": 96,
            "type": "added",
            "content": ""
          },
          {
            "line": 97,
            "type": "added",
            "content": "    // Nettoyage de code"
          },
          {
            "line": 98,
            "type": "added",
            "content": "    markdown += `## 🧹 Nettoyage de code\\n`;"
          },
          {
            "line": 99,
            "type": "added",
            "content": "    markdown += `- Suppression de variables inutilisées : \\`today\\`, \\`dateStr\\`\\n`;"
          },
          {
            "line": 100,
            "type": "added",
            "content": "    markdown += `- Suppression d’un import non utilisé : \\`const os = require('os')\\`\\n`;"
          },
          {
            "line": 101,
            "type": "added",
            "content": ""
          },
          {
            "line": 102,
            "type": "added",
            "content": "    fs.writeFileSync(rapportPath, markdown, 'utf-8');"
          },
          {
            "line": 103,
            "type": "added",
            "content": "    console.log(`Rapport généré: ${rapportPath} `);"
          },
          {
            "line": 104,
            "type": "added",
            "content": "}"
          },
          {
            "line": 105,
            "type": "added",
            "content": ""
          },
          {
            "line": 106,
            "type": "added",
            "content": "function getPreviousWeekRange() {"
          },
          {
            "line": 107,
            "type": "added",
            "content": "    const today = new Date();"
          },
          {
            "line": 108,
            "type": "added",
            "content": "    const dayOfWeek = today.getDay(); // 0 = dimanche"
          },
          {
            "line": 109,
            "type": "added",
            "content": "    const lastMonday = new Date(today);"
          },
          {
            "line": 110,
            "type": "added",
            "content": "    lastMonday.setDate(today.getDate() - dayOfWeek - 6);"
          },
          {
            "line": 111,
            "type": "added",
            "content": "    lastMonday.setHours(0, 0, 0, 0);"
          },
          {
            "line": 112,
            "type": "added",
            "content": ""
          },
          {
            "line": 113,
            "type": "added",
            "content": "    const lastSunday = new Date(lastMonday);"
          },
          {
            "line": 114,
            "type": "added",
            "content": "    lastSunday.setDate(lastMonday.getDate() + 6);"
          },
          {
            "line": 115,
            "type": "added",
            "content": "    lastSunday.setHours(23, 59, 59, 999);"
          },
          {
            "line": 116,
            "type": "added",
            "content": ""
          },
          {
            "line": 117,
            "type": "added",
            "content": "    return { start: lastMonday, end: lastSunday };"
          },
          {
            "line": 118,
            "type": "added",
            "content": "}"
          },
          {
            "line": 119,
            "type": "added",
            "content": ""
          },
          {
            "line": 120,
            "type": "added",
            "content": "function getWeeklyExportFiles(startDate, endDate) {"
          },
          {
            "line": 121,
            "type": "added",
            "content": "    const files = fs.readdirSync(exportFolder);"
          },
          {
            "line": 122,
            "type": "added",
            "content": "    return files.filter(file => {"
          },
          {
            "line": 123,
            "type": "added",
            "content": "        if (!file.startsWith('export_prs_') || !file.endsWith('.json')) return false;"
          },
          {
            "line": 124,
            "type": "added",
            "content": "        const dateStr = file.slice(11, -5);"
          },
          {
            "line": 125,
            "type": "added",
            "content": "        const fileDate = new Date(dateStr);"
          },
          {
            "line": 126,
            "type": "added",
            "content": "        return fileDate >= startDate && fileDate <= endDate;"
          },
          {
            "line": 127,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 128,
            "type": "added",
            "content": "}"
          },
          {
            "line": 129,
            "type": "added",
            "content": ""
          },
          {
            "line": 130,
            "type": "added",
            "content": "function mergePRs(files) {"
          },
          {
            "line": 131,
            "type": "added",
            "content": "    const merged = {};"
          },
          {
            "line": 132,
            "type": "added",
            "content": "    files.forEach(file => {"
          },
          {
            "line": 133,
            "type": "added",
            "content": "        const content = JSON.parse(fs.readFileSync(path.join(exportFolder, file), 'utf-8'));"
          },
          {
            "line": 134,
            "type": "added",
            "content": "        content.forEach(pr => {"
          },
          {
            "line": 135,
            "type": "added",
            "content": "            if (pr.number) merged[pr.number] = pr;"
          },
          {
            "line": 136,
            "type": "added",
            "content": "        });"
          },
          {
            "line": 137,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 138,
            "type": "added",
            "content": "    return Object.values(merged);"
          },
          {
            "line": 139,
            "type": "added",
            "content": "}"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        // Nettoyage de code"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `## 🧹 Nettoyage de code\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `- Suppression de variables inutilisées : \\`today\\`, \\`dateStr\\`\\n`;"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        markdown += `- Suppression d’un import non utilisé : \\`const os = require('os')\\`\\n`;"
          },
          {
            "line": 141,
            "type": "added",
            "content": "function generateMarkdown(prs, startStr, endStr) {"
          },
          {
            "line": 142,
            "type": "added",
            "content": "    const totalPRs = prs.length;"
          },
          {
            "line": 143,
            "type": "added",
            "content": "    const users = {};"
          },
          {
            "line": 144,
            "type": "added",
            "content": "    prs.forEach(pr => {"
          },
          {
            "line": 145,
            "type": "added",
            "content": "        const login = pr.user?.login || 'inconnu';"
          },
          {
            "line": 146,
            "type": "added",
            "content": "        if (!users[login]) users[login] = [];"
          },
          {
            "line": 147,
            "type": "added",
            "content": "        users[login].push(pr);"
          },
          {
            "line": 148,
            "type": "added",
            "content": "    });"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        fs.writeFileSync(rapportPath, markdown, 'utf-8');"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        console.log(`Rapport généré: ${rapportPath} `);"
          },
          {
            "line": 150,
            "type": "added",
            "content": "    let md = `# Rapport hebdomadaire des PRs\\n\\n`;"
          },
          {
            "line": 151,
            "type": "added",
            "content": "    md += `📅 Semaine du **${startStr}** au **${endStr}**\\n\\n`;"
          },
          {
            "line": 152,
            "type": "added",
            "content": "    md += `## 📊 Résumé global\\n`;"
          },
          {
            "line": 153,
            "type": "added",
            "content": "    md += `- Nombre total de PRs : ${totalPRs}\\n`;"
          },
          {
            "line": 154,
            "type": "added",
            "content": "    md += `- Contributeurs uniques : ${Object.keys(users).length}\\n\\n`;"
          },
          {
            "line": 155,
            "type": "added",
            "content": ""
          },
          {
            "line": 156,
            "type": "added",
            "content": "    md += `## 👤 Analyse par utilisateur\\n`;"
          },
          {
            "line": 157,
            "type": "added",
            "content": "    for (const [login, prList] of Object.entries(users)) {"
          },
          {
            "line": 158,
            "type": "added",
            "content": "        md += `### 🔹 ${login}\\n`;"
          },
          {
            "line": 159,
            "type": "added",
            "content": "        md += `- Nombre de PRs : ${prList.length}\\n`;"
          },
          {
            "line": 160,
            "type": "added",
            "content": "        prList.forEach(pr => {"
          },
          {
            "line": 161,
            "type": "added",
            "content": "            md += `  - #${pr.number} : ${pr.title} (${pr.state})\\n`;"
          },
          {
            "line": 162,
            "type": "added",
            "content": "        });"
          },
          {
            "line": 163,
            "type": "added",
            "content": "        md += `\\n`;"
          },
          {
            "line": 166,
            "type": "added",
            "content": "    return md;"
          },
          {
            "line": 167,
            "type": "added",
            "content": "}"
          },
          {
            "line": 168,
            "type": "added",
            "content": ""
          },
          {
            "line": 169,
            "type": "added",
            "content": "function generateWeeklyMarkdownReport() {"
          },
          {
            "line": 170,
            "type": "added",
            "content": "    const { start, end } = getPreviousWeekRange();"
          },
          {
            "line": 171,
            "type": "added",
            "content": "    const startStr = dayjs(start).format('YYYY-MM-DD');"
          },
          {
            "line": 172,
            "type": "added",
            "content": "    const endStr = dayjs(end).format('YYYY-MM-DD');"
          },
          {
            "line": 173,
            "type": "added",
            "content": "    const files = getWeeklyExportFiles(start, end);"
          },
          {
            "line": 174,
            "type": "added",
            "content": "    const mergedPRs = mergePRs(files);"
          },
          {
            "line": 175,
            "type": "added",
            "content": ""
          },
          {
            "line": 176,
            "type": "added",
            "content": "    const markdown = generateMarkdown(mergedPRs, startStr, endStr);"
          },
          {
            "line": 177,
            "type": "added",
            "content": "    const outputName = `rapport_hebdo_${startStr}_au_${endStr}.md`;"
          },
          {
            "line": 178,
            "type": "added",
            "content": "    const outputPath = path.join(exportFolder, outputName);"
          },
          {
            "line": 179,
            "type": "added",
            "content": "    fs.writeFileSync(outputPath, markdown, 'utf-8');"
          },
          {
            "line": 180,
            "type": "added",
            "content": "    console.log(`✅ Rapport Markdown hebdomadaire généré : ${outputName}`);"
          },
          {
            "line": 181,
            "type": "added",
            "content": "}"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    module.exports = { generateRapportMarkdown };"
          },
          {
            "line": 183,
            "type": "added",
            "content": "module.exports = { generateRapportMarkdown, generateWeeklyMarkdownReport };"
          }
        ],
        "diff": []
      },
      {
        "filename": "server.js",
        "status": "modified",
        "additions": 45,
        "deletions": 31,
        "changes": 76,
        "raw_url": "https://github.com/fournest85/projet_1_back/raw/e0db981a9766038a7cd8665d612249392f96fc06/server.js",
        "modifiedLines": [
          {
            "line": 30,
            "type": "added",
            "content": "app.get('/api/config', (req, res) => {"
          },
          {
            "line": 31,
            "type": "added",
            "content": "  console.log('✅ Route /api/config appelée');"
          },
          {
            "line": 32,
            "type": "added",
            "content": "  const backendPort = process.env.PORT || 3000;"
          },
          {
            "line": 33,
            "type": "added",
            "content": ""
          },
          {
            "line": 34,
            "type": "added",
            "content": "  res.json({"
          },
          {
            "line": 35,
            "type": "added",
            "content": "    apiUrl: `http://localhost:${backendPort}/api/users`,"
          },
          {
            "line": 36,
            "type": "added",
            "content": "    backendPort,"
          },
          {
            "line": 37,
            "type": "added",
            "content": "    dbName: process.env.DB_NAME,"
          },
          {
            "line": 38,
            "type": "added",
            "content": "    githubRepo: process.env.GITHUB_REPO,"
          },
          {
            "line": 39,
            "type": "added",
            "content": "    githubOwner: process.env.GITHUB_OWNER"
          },
          {
            "line": 40,
            "type": "added",
            "content": "  });"
          },
          {
            "line": 41,
            "type": "added",
            "content": "});"
          },
          {
            "line": 46,
            "type": "added",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "    const rl = readline.createInterface({"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        input: process.stdin,"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        output: process.stdout"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    });"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "    rl.question('📅 Entrez une date (YYYY-MM-DD) ou appuyez sur Entrée pour utiliser la date d’hier : ', (input) => {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        rl.close();"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        callback(input.trim());"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    });"
          },
          {
            "line": 65,
            "type": "added",
            "content": "  const rl = readline.createInterface({"
          },
          {
            "line": 66,
            "type": "added",
            "content": "    input: process.stdin,"
          },
          {
            "line": 67,
            "type": "added",
            "content": "    output: process.stdout"
          },
          {
            "line": 68,
            "type": "added",
            "content": "  });"
          },
          {
            "line": 69,
            "type": "added",
            "content": ""
          },
          {
            "line": 70,
            "type": "added",
            "content": "  rl.question('📅 Entrez une date (YYYY-MM-DD) ou appuyez sur Entrée pour utiliser la date d’hier : ', (input) => {"
          },
          {
            "line": 71,
            "type": "added",
            "content": "    rl.close();"
          },
          {
            "line": 72,
            "type": "added",
            "content": "    callback(input.trim());"
          },
          {
            "line": 73,
            "type": "added",
            "content": "  });"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    if (err) {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        console.error('❌ Failed to connect to the database');"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        process.exit(-1);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    } else {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        console.log('✅ Connected to the database');"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "        // Démarrage du serveur"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        app.listen(port, async () => {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            console.log(`Server is running on http://localhost:${port}`);"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            open(`http://localhost:5000`);"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "            demanderDate(async (inputDate) => {"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                const dateToUse = inputDate || new Date(Date.now() - 86400000).toISOString().split('T')[0];"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                await runStartupTasks(dateToUse, API_URL);"
          },
          {
            "line": null,
            "type": "removed",
            "content": ""
          },
          {
            "line": null,
            "type": "removed",
            "content": "                // Lancement du cron"
          },
          {
            "line": null,
            "type": "removed",
            "content": "                initGithubCron();"
          },
          {
            "line": null,
            "type": "removed",
            "content": "            });"
          },
          {
            "line": null,
            "type": "removed",
            "content": "        });"
          },
          {
            "line": null,
            "type": "removed",
            "content": "    }"
          },
          {
            "line": 78,
            "type": "added",
            "content": "  if (err) {"
          },
          {
            "line": 79,
            "type": "added",
            "content": "    console.error('❌ Failed to connect to the database');"
          },
          {
            "line": 80,
            "type": "added",
            "content": "    process.exit(-1);"
          },
          {
            "line": 81,
            "type": "added",
            "content": "  } else {"
          },
          {
            "line": 82,
            "type": "added",
            "content": "    console.log('✅ Connected to the database');"
          },
          {
            "line": 83,
            "type": "added",
            "content": "    // Démarrage du serveur"
          },
          {
            "line": 84,
            "type": "added",
            "content": "    server = app.listen(port, async () => {"
          },
          {
            "line": 85,
            "type": "added",
            "content": "      const backendPort = port;"
          },
          {
            "line": 86,
            "type": "added",
            "content": "      console.log(`✅ Server is running on http://localhost:${backendPort}`);"
          },
          {
            "line": 87,
            "type": "added",
            "content": ""
          },
          {
            "line": 88,
            "type": "added",
            "content": "      // Ouvre le navigateur sur le frontend (live-server)"
          },
          {
            "line": 89,
            "type": "added",
            "content": "      if (process.env.FROM_CONCURRENTLY === 'true') {"
          },
          {
            "line": 90,
            "type": "added",
            "content": "        await open('http://localhost:8080');"
          },
          {
            "line": 91,
            "type": "added",
            "content": "      }"
          },
          {
            "line": 92,
            "type": "added",
            "content": ""
          },
          {
            "line": 93,
            "type": "added",
            "content": "      // Lancement des tâches"
          },
          {
            "line": 94,
            "type": "added",
            "content": "      demanderDate(async (inputDate) => {"
          },
          {
            "line": 95,
            "type": "added",
            "content": "        const dateToUse = inputDate || new Date(Date.now() - 86400000).toISOString().split('T')[0];"
          },
          {
            "line": 96,
            "type": "added",
            "content": "        await runStartupTasks(dateToUse, API_URL);"
          },
          {
            "line": 97,
            "type": "added",
            "content": "        initGithubCron();"
          },
          {
            "line": 98,
            "type": "added",
            "content": "      });"
          },
          {
            "line": 99,
            "type": "added",
            "content": "    });"
          },
          {
            "line": 100,
            "type": "added",
            "content": "  }"
          }
        ],
        "diff": []
      }
    ],
    "id": 2904439376,
    "repo": "projet_1_back",
    "state": "closed",
    "title": "Mise à jour des scripts et ajout des exports du 09/10",
    "updated_at": "2025-10-10T15:25:22.000Z",
    "user": {
      "name": null,
      "email": null,
      "phone": null,
      "githubId": 233725179,
      "githubUrl": "https://github.com/fournest85"
    }
  }
]